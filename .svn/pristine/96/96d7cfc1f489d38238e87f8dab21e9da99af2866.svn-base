webpackJsonp([16],{"71Tu":function(t,e){},rDpM:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Xxa5"),n=s.n(a),i=s("exGp"),r=s.n(i),l=s("gyMJ"),o={name:"community",data:function(){return{className:this.$store.getters.className,imagesList:[],classList:[],query:{id:this.$store.getters.id,roleType:this.$store.getters.roleType},form:{openId:this.$store.getters.openId,classId:this.$store.getters.classId,contentType:0,textContent:"",images:[],video:""}}},methods:{handleChooseImage:function(){this.$wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){console.log(t);var e=t.localIds;console.log(e)}})},handleSelectClass:function(){var t=this;this.$weui.picker(this.classList,{defaultValue:[this.form.classId],onConfirm:function(e){t.className=e[0].label,t.form.classId=e[0].value}})},handleDelImg:function(t){return this.form.images.splice(t,1)},handleChangeFile:function(t){var e=t.target.files;e.length&&this.handleShowImg(e)},handleShowImg:function(t){for(var e=this,s=0;s<t.length;s++){var a=t[s];if(/^image\//.test(a.type)){var n=new FileReader;n.onload=function(t){e.form.images.push(t.target.result)},n.readAsDataURL(a)}}},handleSubmit:function(){var t=this.form,e=t.textContent,s=t.classId;""!=e?null!=s&&""!=this.className?this.communityAdd(this.form):this.$weui.alert("请选择发送的班级",function(){},{title:"提示"}):this.$weui.alert("请输入内容",function(){},{title:"提示"})},queryClassId:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r()(n.a.mark(function s(){var a,i;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,l.a.queryClassId(e);case 2:0===(a=s.sent).errorCode&&(i=a.data.map(function(t){return{label:t.className,value:t.classId}}),t.classList=i);case 4:case"end":return s.stop()}},s,t)}))()},communityAdd:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r()(n.a.mark(function s(){return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,l.a.communityAdd(e);case 2:0===s.sent.errorCode&&t.$weui.alert("发布成功",function(){t.$router.go(-1)},{title:"提示"});case 4:case"end":return s.stop()}},s,t)}))()},getWxConfig:function(){var t=this;return r()(n.a.mark(function e(){var s,a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=window.location.href.split("#")[0],t.next=3,l.a.sign({url:s});case 3:0===(a=t.sent).errorCode&&console.log(a);case 5:case"end":return t.stop()}},e,t)}))()}},mounted:function(){this.queryClassId(this.query),this.getWxConfig()}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("div",{staticClass:"page-bd"},[a("form",{ref:"form",attrs:{action:"",method:"post",enctype:"multipart/form-data"}},[a("input",{attrs:{type:"submit",id:"submission",hidden:""}}),t._v(" "),a("div",{staticClass:"cells"},[a("div",{staticClass:"cell"},[a("div",{staticClass:"cell-bd",staticStyle:{"padding-left":"0"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.textContent,expression:"form.textContent"}],staticClass:"textarea",attrs:{placeholder:"记录下孩子的成长点滴~",rows:"6"},domProps:{value:t.form.textContent},on:{input:function(e){e.target.composing||t.$set(t.form,"textContent",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"cell"},[a("div",{staticClass:"cell-bd",staticStyle:{"padding-left":"0"}},[a("ul",{staticClass:"uploader-files"},t._l(t.form.images,function(e,n){return a("li",{key:n,staticClass:"uploader-file",style:{backgroundImage:"url("+e+")"}},[a("img",{attrs:{src:s("+Vg6"),alt:""},on:{click:function(e){t.handleDelImg(n)}}})])})),t._v(" "),a("div",{staticClass:"uploader-input_box"})])]),t._v(" "),a("div",{staticClass:"cell"},[t._m(0),t._v(" "),a("div",{staticClass:"cell-bd",staticStyle:{"padding-left":"0"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.className,expression:"className"}],staticClass:"input",attrs:{type:"text",readonly:"",placeholder:"请选择发送的班级"},domProps:{value:t.className},on:{click:t.handleSelectClass,input:function(e){e.target.composing||(t.className=e.target.value)}}})])])])])]),t._v(" "),a("div",{staticClass:"page-ft"},[a("div",{staticClass:"btn-area"},[a("a",{staticClass:"btn btn-primary",attrs:{href:"javascript:;",id:"btn-Submission"},on:{click:t.handleSubmit}},[t._v("发布")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cell-hd"},[e("label",{staticClass:"label",attrs:{for:""}},[this._v("发送班级")])])}]};var u=s("VU/8")(o,c,!1,function(t){s("71Tu")},"data-v-7650ff90",null);e.default=u.exports}});
//# sourceMappingURL=16.f185f5e46440005fd73e.js.map