webpackJsonp([24],{DdN4:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Xxa5"),l=s.n(a),r=s("exGp"),n=s.n(r),i=s("woOf"),c=s.n(i),o=s("gyMJ"),d=s("wEM1"),u=s("w3CS"),v={name:"studentAdd",mixins:[d.c,d.a],data:function(){return{form:{openId:this.$route.query.openId,studentName:"",sex:1,linkMan:[{relation:1,tel:""}],classId:null},classList:[]}},methods:{handleAddLinkMan:function(){this.form.linkMan.push({relation:1,tel:""})},handleDelLinkMan:function(t){return this.form.linkMan.splice(t,1)},handleSubmit:function(){var t=this.form,e=t.studentName,s=t.classId,a=t.linkMan;if(""==e||!e.length)return this.$toast("请输入学生姓名"),!1;if(!s)return this.$toast("请选择学生所在班级"),!1;for(var l=0;l<a.length;l++){var r=a[l].tel;if(!Object(u.a)(r))return void this.$toast("请正确填写手机号")}var n=c()({},this.form);this.studentAdd(n)},studentAdd:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n()(l.a.mark(function s(){var a;return l.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.a.studentAdd(e);case 2:0===(a=s.sent).errorCode?(t.$refs.form.reset(),t.$router.go(-1)):-1===a.errorCode?t.$toast(""+a.errorMsg):2===a.errorCode&&t.$dialog.alert({message:""+a.errorMsg}).then(function(){t.$refs.form.reset(),t.$router.go(-1)});case 4:case"end":return s.stop()}},s,t)}))()},queryClassGroup:function(){var t=this;return n()(l.a.mark(function e(){var s,a,r,n,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.$route.query,a=s.id,r=s.studentId,n=s.roleType,e.next=3,o.a.queryClassId({id:a,studentId:r,roleType:n});case 3:0===(i=e.sent).errorCode&&(t.classList=i.data);case 5:case"end":return e.stop()}},e,t)}))()}},mounted:function(){this.queryClassGroup()}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-page"},[s("div",{staticClass:"flex-bd"},[s("form",{ref:"form",attrs:{action:""}},[s("div",{staticClass:"cells-title"},[t._v("基础信息")]),t._v(" "),s("div",{staticClass:"cells"},[s("div",{staticClass:"cell"},[t._m(0),t._v(" "),s("div",{staticClass:"cell-bd"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.studentName,expression:"form.studentName"}],staticClass:"input",attrs:{placeholder:"请输入学生姓名",maxlength:"5"},domProps:{value:t.form.studentName},on:{input:function(e){e.target.composing||t.$set(t.form,"studentName",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"cell cell-select cell-select-after"},[t._m(1),t._v(" "),s("div",{staticClass:"cell-bd"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.form.sex,expression:"form.sex"}],staticClass:"select",attrs:{name:"",dir:"rtl"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.form,"sex",e.target.multiple?s:s[0])}}},t._l(t.sexList,function(e,a){return s("option",{key:a,domProps:{value:e.id}},[t._v(t._s(e.name))])}))])]),t._v(" "),s("div",{staticClass:"cell cell-select cell-select-after"},[t._m(2),t._v(" "),s("div",{staticClass:"cell-bd"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.form.classId,expression:"form.classId"}],staticClass:"select",attrs:{name:"",dir:"rtl"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.form,"classId",e.target.multiple?s:s[0])}}},[s("optgroup",{attrs:{disabled:"",hidden:""}}),t._v(" "),t._l(t.classList,function(e,a){return s("option",{key:a,domProps:{value:e.classId}},[t._v(t._s(e.className))])})],2)])])]),t._v(" "),s("div",{staticClass:"cells-title"},[s("span"),t._v(" "),s("a",{staticClass:"btn btn-primary",attrs:{href:"javascript:void(0);"},on:{click:t.handleAddLinkMan}},[t._v("新增家长")])]),t._v(" "),t._l(t.form.linkMan,function(e,a){return s("div",{key:a,staticClass:"cells"},[s("div",{staticClass:"cell"},[t._m(3,!0),t._v(" "),s("div",{staticClass:"cell-bd"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tel,expression:"link.tel"}],staticClass:"input",attrs:{type:"number",pattern:"[0-9]*",placeholder:"请输入手机号"},domProps:{value:e.tel},on:{input:function(s){s.target.composing||t.$set(e,"tel",s.target.value)}}})])]),t._v(" "),s("div",{staticClass:"cell cell-select cell-select-after"},[t._m(4,!0),t._v(" "),s("div",{staticClass:"cell-bd"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.relation,expression:"link.relation"}],staticClass:"select",attrs:{name:"",dir:"rtl"},on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(e,"relation",s.target.multiple?a:a[0])}}},[s("optgroup",{attrs:{disabled:"",hidden:""}}),t._v(" "),t._l(t.relationList,function(e,a){return s("option",{key:a,domProps:{value:e.id}},[t._v(t._s(e.name))])})],2)])]),t._v(" "),t.form.linkMan.length>1?s("div",{staticClass:"cells-footer"},[s("div",{staticClass:"cell"},[s("a",{staticClass:"btn btn-warn",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.handleDelLinkMan(a)}}},[t._v("删除")])])]):t._e()])})],2),t._v(" "),s("div",{staticClass:"btn-group"},[s("a",{staticClass:"btn btn-large btn-primary",attrs:{href:"javascript:void(0);"},on:{click:t.handleSubmit}},[t._v("保存")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cell-hd"},[e("label",{staticClass:"label"},[this._v("学生姓名")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cell-hd"},[e("label",{staticClass:"label",attrs:{for:""}},[this._v("性别")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cell-hd"},[e("label",{staticClass:"label",attrs:{for:""}},[this._v("学生所在班级")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cell-hd"},[e("label",{staticClass:"label"},[this._v("家长手机号")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cell-hd"},[e("label",{staticClass:"label",attrs:{for:""}},[this._v("学生和家长关系")])])}]};var m=s("VU/8")(v,f,!1,function(t){s("VWUc")},"data-v-7790ba87",null);e.default=m.exports},VWUc:function(t,e){}});