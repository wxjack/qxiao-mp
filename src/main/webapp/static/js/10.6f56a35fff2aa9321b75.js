webpackJsonp([10],{"/cXw":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),i=a("Xxa5"),s=a.n(i),o=a("exGp"),c=a.n(o),l=a("gyMJ"),u={name:"action",mixins:[a("0wMN").a],data:function(){return{statrCount:0,query:{openId:this.$route.query.openId,page:1,pageSize:20},form:{openId:this.$route.query.openId,textContent:"",starCount:""},pageData:[],total:0}},methods:{onClose:function(t,e,a){var r=this;return function(n,i){switch(n){case"right":r.$dialog.confirm({title:"提示",message:"确认要删除该行为标准吗?"}).then(c()(s.a.mark(function n(){var o;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i.close(),o={openId:r.$route.query.openId,itemId:e,prizeType:a},n.next=4,l.a.prizeDelete(o);case 4:0===n.sent.errorCode&&r.pageData.splice(t,1);case 6:case"end":return n.stop()}},n,r)}))).catch(function(){i.close()})}}},chg:function(){var t=0;this.pageData.forEach(function(e){e.checked&&(t+=e.starCount*e.value)}),this.total=t},handleSubmit:function(t,e){var a=this;return c()(s.a.mark(function r(){return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("confirm"!==t){r.next=15;break}if(""!=a.form.textContent){r.next=5;break}return a.$toast("请输入奖项说明"),e(!1),r.abrupt("return");case 5:if(""!=a.form.starCount){r.next=9;break}return a.$toast("请输入Q星数量"),e(!1),r.abrupt("return");case 9:return r.next=11,l.a.prizeAdd(a.form);case 11:0===r.sent.errorCode&&(e(),a.dialogVisible=!1,a.prizeListQuery(a.query)),r.next=16;break;case 15:e();case 16:case"end":return r.stop()}},r,a)}))()},handleSave:function(){if(this.total)if(this.total>this.statrCount)this.$toast("你的Q星数量不够兑换的奖项哦");else{var t=[];if(this.pageData.forEach(function(e){e.checked&&t.push({itemId:e.itemId,times:e.value,prizeType:e.prizeType})}),t.length){var e={studentId:this.$route.query.studentId,openId:this.$route.query.openId,itemArray:t};this.prizeExchange(e)}}else this.$toast("请勾选你要兑换的奖项")},queryTotalCountStar:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c()(s.a.mark(function a(){var r;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.queryTotalCountStar(e);case 2:0===(r=a.sent).errorCode&&(t.statrCount=r.data.totalCountStar);case 4:case"end":return a.stop()}},a,t)}))()},prizeExchange:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.prizeExchange(e);case 2:0===a.sent.errorCode&&t.$dialog.alert({message:"奖励兑换成功"}).then(function(){t.queryTotalCountStar(t.$route.query),t.prizeListQuery(t.query)});case 4:case"end":return a.stop()}},a,t)}))()},prizeListQuery:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c()(s.a.mark(function a(){var r,i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.prizeListQuery(e);case 2:0===(r=a.sent).errorCode&&(i=r.data.data.map(function(t){return n()({},t,{checked:!1,value:1})}),t.pageData=i);case 4:case"end":return a.stop()}},a,t)}))()}},mounted:function(){this.queryTotalCountStar(this.$route.query),this.prizeListQuery(this.query)}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-page"},[a("div",{staticClass:"flex-bd"},[a("van-dialog",{attrs:{title:"添加奖励","show-cancel-button":"","before-close":t.handleSubmit},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("form",{staticClass:"form"},[a("div",{staticClass:"form-item"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.textContent,expression:"form.textContent"}],staticClass:"textarea min-h400",attrs:{placeholder:"请输入与孩子约定奖项内容,例如奖励20分钟游戏时间..."},domProps:{value:t.form.textContent},on:{input:function(e){e.target.composing||t.$set(t.form,"textContent",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.starCount,expression:"form.starCount"}],staticClass:"input input-border",attrs:{type:"number",placeholder:"请输入Q星数量"},domProps:{value:t.form.starCount},on:{input:function(e){e.target.composing||t.$set(t.form,"starCount",e.target.value)}}})])])]),t._v(" "),a("div",{staticClass:"mod"},[a("div",{staticClass:"pichi"},[a("div",{staticClass:"pichi-box"},[t._m(0),t._v(" "),a("div",{staticClass:"pichi-meta"},[a("span",[t._v("可交换Q星")]),t._v(" "),a("p",[t._v(t._s(t.statrCount))])])]),t._v(" "),a("div",{staticClass:"pichi-btn"},[a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("添加奖励")]),t._v(" "),a("router-link",{attrs:{to:{path:"/prize/log",query:{openId:"12456",studentId:1}}}},[t._v("兑换记录")])],1)])]),t._v(" "),t._m(1),t._v(" "),a("div",{staticClass:"cells mb-30"},t._l(t.pageData,function(e,r){return a("van-swipe-cell",{key:e.itemId,ref:"swipeCell",refInFor:!0,attrs:{"right-width":60,disabled:0===e.prizeType,"on-close":t.onClose(r,e.itemId,e.prizeType)}},[a("van-cell-group",[a("div",{staticClass:"cell min-h160"},[a("div",{staticClass:"cell-hd"},[a("van-checkbox",{attrs:{"checked-color":"#04b6ff"},on:{change:t.chg},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}})],1),t._v(" "),a("div",{staticClass:"cell-bd pl-20"},[a("p",{staticClass:"mb-20",attrs:{"size-16":""}},[t._v(t._s(e.textContent))]),t._v(" "),a("p",{staticStyle:{color:"#ff4d67"}},[t._v(t._s(e.starCount)+"颗")])]),t._v(" "),a("div",{staticClass:"cell-ft"},[a("van-stepper",{on:{change:t.chg},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)])]),t._v(" "),a("span",{staticStyle:{"line-height":"80px"},attrs:{slot:"right"},slot:"right"},[t._v("删除")])],1)}))],1),t._v(" "),a("div",{staticClass:"flex-ft"},[a("div",{staticClass:"tapeti"},[a("div",{staticClass:"tapeti-left"},[a("p",{staticClass:"pl-20"},[t._v("合计Q星: "+t._s(t.total))])]),t._v(" "),a("div",{staticClass:"tapeti-right"},[a("van-button",{attrs:{type:"info"},on:{click:t.handleSave}},[t._v("兑换")])],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pichi-figure",attrs:{radius:"50"}},[e("img",{attrs:{src:a("xlGX"),width:"30",height:"30"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cells-title"},[e("p",[this._v("奖励列表")])])}]};var p=a("VU/8")(u,d,!1,function(t){a("r2ye")},"data-v-91607cca",null);e.default=p.exports},r2ye:function(t,e){},xlGX:function(t,e){t.exports="data:image/png;base64,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"}});