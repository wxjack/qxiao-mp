webpackJsonp([16],{"9UeQ":function(e,t){},oISE:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),r=s.n(a),i=s("exGp"),n=s.n(i),o=s("Dd8w"),c=s.n(o),l=s("gyMJ"),u=s("NYxO"),d={name:"fresh",mixins:[s("a9+M").a],data:function(){return{long:0,time:0,popupShow:!1,className:this.$route.query.className,classId:this.$route.query.classId,isLoading:!1,totalPage:1,query:{openId:this.$route.query.openId,classId:this.$route.query.classId,studentId:this.$route.query.studentId,page:1,pageSize:10},roleType:this.$route.query.roleType,queryClass:{id:this.$route.query.id,roleType:this.$route.query.roleType},freshData:[]}},computed:c()({},Object(u.b)("queryClass",{classList:function(e){return e.classList}})),filters:{brReplace:function(e){return e?e.replace(/<br\/>/g,""):""}},methods:{onClose:function(e,t){var s=this;return function(a,i){switch(a){case"right":s.$dialog.confirm({title:"提示",message:"确定删除该条速报吗？"}).then(n()(r.a.mark(function a(){var i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i={openId:s.query.openId,freshId:e.freshId},a.next=3,l.a.deleteFresh(i);case 3:0===a.sent.errorCode&&s.freshData.splice(t,1);case 5:case"end":return a.stop()}},a,s)}))).catch(function(){i.close()})}}},go:function(e){var t=e.freshId,s=e.classId,a=e.studentId;this.$router.push({path:"/fresh/show",query:{freshId:t,classId:s,studentId:a}})},handleClassConfirm:function(e){this.popupShow=!1,this.className=e.className,this.query.classId=e.classId,this.freshQuery(this.query)},handleLoadingMore:function(e){var t=this,s=0;document.documentElement&&document.documentElement.scrollTop?s=document.documentElement.scrollTop:document.body&&(s=document.body.scrollTop),document.body.offsetHeight-s-window.innerHeight<=200&&!1===this.isLoading&&this.query.page<this.totalPage&&(this.isLoading=!0,this.query.page+=1,l.a.freshQuery(this.query).then(function(e){if(0===e.errorCode){t.totalPage=e.data.totalPage,t.query.page=e.data.page,t.isLoading=!1;var s=e.data.data;s.length&&s.forEach(function(e){t.freshData.push(e)})}}))},deleteFresh:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n()(r.a.mark(function s(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.deleteFresh(t);case 2:e.sent.errorCode;case 4:case"end":return e.stop()}},s,e)}))()},freshQuery:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n()(r.a.mark(function s(){var a;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,l.a.freshQuery(t);case 2:0===(a=s.sent).errorCode&&(e.popupShow=!1,e.query.page=a.data.page,e.totalPage=a.data.totalPage,e.isLoading=!1,e.freshData=a.data.data||[]);case 4:case"end":return s.stop()}},s,e)}))()}},mounted:function(){this.wxSdk.wxShare(this.roleType),this.freshQuery(this.query)}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[1==e.roleType||2==e.roleType||4==e.roleType?[a("div",{staticClass:"page-hd"},[a("div",{staticClass:"button-sp-area flex",attrs:{"size-17":""}},[a("a",{attrs:{href:"javascript:void(0);",id:"showDatePicker"},on:{click:function(t){e.popupShow=!0}}},[a("span",[e._v(e._s(e.className))]),e._v(" "),a("van-icon",{attrs:{name:"arrow-down",size:"16px"}})],1)])])]:e._e(),e._v(" "),a("div",{staticClass:"page-bd"},[a("van-popup",{attrs:{position:"bottom"},model:{value:e.popupShow,callback:function(t){e.popupShow=t},expression:"popupShow"}},[a("div",{staticClass:"popup-class"},[a("div",{staticClass:"cells"},e._l(e.classList,function(t,r){return a("div",{key:r,staticClass:"cell popup-box"},[a("div",{staticClass:"cell-hd"},[a("img",{attrs:{src:s("UHh/"),width:"54",height:"54"}})]),e._v(" "),a("div",{staticClass:"cell-bd"},[a("p",[e._v(e._s(t.className))])]),e._v(" "),a("div",{staticClass:"cell-ft"},[a("van-radio-group",{model:{value:e.classId,callback:function(t){e.classId=t},expression:"classId"}},[a("van-radio",{attrs:{name:t.classId,"checked-color":"#92cd36"},on:{click:function(s){e.handleClassConfirm(t)}}})],1)],1)])}))])]),e._v(" "),2==e.roleType?[a("router-link",{staticClass:"release",attrs:{to:"/fresh/add"}},[a("van-icon",{attrs:{name:"description",size:"24px"}})],1)]:e._e(),e._v(" "),e._l(e.freshData,function(t,s){return a("van-swipe-cell",{key:s,ref:"swipeCell",refInFor:!0,attrs:{"right-width":60,disabled:3!==e.roleType,"on-close":e.onClose(t,s)}},[a("van-cell-group",[a("figure",{staticClass:"figure figure-skin-two",on:{click:function(s){e.go(t)}}},[a("div",{staticClass:"figure-bd"},[a("div",{staticClass:"figure-info"},[a("figcaption",{staticClass:"text-ellipsis",attrs:{"size-18":""}},[e._v(e._s(t.title))]),e._v(" "),a("div",{staticClass:"metedata flex"},[a("time",{staticClass:"time"},[e._v(e._s(t.postTime))])]),e._v(" "),t.topImage?a("div",{staticClass:"figure-thumb-medium",style:{backgroundImage:"url("+t.topImage+")"}}):e._e(),e._v(" "),a("p",{staticClass:"line-clamp"},[e._v(e._s(e._f("brReplace")(t.textContent)))])])]),e._v(" "),a("div",{staticClass:"figure-ft"},[a("div",{staticClass:"figure-icon"},[a("van-icon",{attrs:{name:"eye-o",size:"16px"}}),e._v(" "),a("b",[e._v(e._s(t.classReadCount))])],1),e._v(" "),a("div",{staticClass:"figure-icon"},[a("van-icon",{attrs:{name:"comment-o",size:"16px"}}),e._v(" "),a("b",[e._v(e._s(t.classCommentCount))])],1)])])]),e._v(" "),a("span",{staticStyle:{"line-height":"80px"},attrs:{slot:"right"},slot:"right"},[e._v("删除")])],1)}),e._v(" "),e.freshData.length?e._e():a("div",{staticClass:"empty"},[a("img",{attrs:{src:s("UHh/"),alt:""}}),e._v(" "),a("p",[e._v("暂无新鲜速报")])])],2)],2)},staticRenderFns:[]};var h=s("VU/8")(d,p,!1,function(e){s("9UeQ")},"data-v-be23a0c2",null);t.default=h.exports}});