webpackJsonp([13],{"+lRy":function(t,e){},ljIf:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),c=a.n(s),n=a("exGp"),o=a.n(n),r=a("woOf"),i=a.n(r),l=a("+6Bu"),u=a.n(l),d=a("Dd8w"),p=a.n(d),h=a("oqQY"),v=a.n(h),f=a("gyMJ"),y=a("NYxO"),k={name:"clock",data:function(){return{popupOne:!1,popupTwo:!1,currentDate:new Date,clockList:[],clockMonthList:[],calendar:{range:!1,lunar:!0,events:{}},query:{openId:this.$route.query.openId,date:v()().subtract(1,"days").format("YYYY-MM-DD")},querys:{studentId:this.$route.query.studentId,openId:this.$route.query.openId,month:v()().format("YYYY-MM-DD")}}},computed:p()({},Object(y.b)("users",{roleType:function(t){return t.roleType}})),methods:{formatter:function(t,e){return"year"===t?e+"年":"month"===t?e+"月":"day"===t?e+"日":e},handleAddPunch:function(){var t=this,e=this.querys.studentId;this.$dialog.confirm({title:"提示",message:"确定接送孩子吗？"}).then(function(){t.addPunch(e)})},handleClockDay:function(t){this.$router.push({path:"/clock/day",query:{day:t}})},handleShowDatePicker:function(t){var e=moment(new Date(t).getTime()).format("YYYY-MM-DD");this.query.date=e,this.clockStat(this.query)},handleChangeMonth:function(t){var e=moment(new Date(t).getTime()).format("YYYY-MM");this.querys.month=e,this.clockQuery(this.querys)},handleQueryClock:function(t){this.$router.push({path:"/clock/show",query:{className:""+t.className,classId:""+t.classId,date:""+t.statDate}})},handleSelect:function(t){console.log(t)},handlePrev:function(t,e){t>0&&t<9&&(t="0"+t);var a=this.querys,s=(a.month,u()(a,["month"])),c=i()({},s,{month:e+"-"+t});this.clockQuery(c)},handleNext:function(t,e){t>0&&t<9&&(t="0"+t);var a=this.querys,s=(a.month,u()(a,["month"])),c=i()({},s,{month:e+"-"+t});this.clockQuery(c)},clockStat:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(c.a.mark(function a(){var s;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.clockStat(e);case 2:0===(s=a.sent).errorCode&&(t.clockList=s.data,t.popupOne=!1);case 4:case"end":return a.stop()}},a,t)}))()},clockQuery:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(c.a.mark(function a(){var s;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.clockQuery(e);case 2:0===(s=a.sent).errorCode&&(t.clockMonthList=s.data,t.popupTwo=!1);case 4:case"end":return a.stop()}},a,t)}))()},addPunch:function(t){var e=this;return o()(c.a.mark(function a(){var s;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.addPunch({studentId:t});case 2:(s=a.sent).errorCode,e.$toast(""+s.errorMsg);case 4:case"end":return a.stop()}},a,e)}))()}},activated:function(){3==this.roleType?this.clockQuery(this.querys):this.clockStat(this.query)}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("div",{staticClass:"page-hd"},[1==t.roleType||2==t.roleType||4==t.roleType?[a("div",{staticClass:"button-sp-area flex",attrs:{"size-17":""}},[a("a",{attrs:{href:"javascript:void(0);",id:"showDatePicker"},on:{click:function(e){t.popupOne=!0}}},[a("span",{attrs:{id:"data1"}},[t._v(t._s(t.query.date))]),t._v(" "),a("van-icon",{attrs:{name:"arrow-down",size:"16px"}})],1)])]:[a("div",{staticClass:"button-sp-area flex",attrs:{"size-17":""}},[a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.popupTwo=!0}}},[a("span",{attrs:{id:"data1"}},[t._v(t._s(t.querys.month))])])])]],2),t._v(" "),a("div",{staticClass:"page-bd"},[a("van-popup",{attrs:{position:"bottom"},model:{value:t.popupOne,callback:function(e){t.popupOne=e},expression:"popupOne"}},[a("van-datetime-picker",{ref:"datetime",attrs:{type:"date",formatter:t.formatter},on:{cancel:function(e){t.popupOne=!1},confirm:t.handleShowDatePicker},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),t._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:t.popupTwo,callback:function(e){t.popupTwo=e},expression:"popupTwo"}},[a("van-datetime-picker",{attrs:{type:"year-month"},on:{confirm:t.handleChangeMonth,cancel:function(e){t.popupTwo=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),t._v(" "),1==t.roleType||2==t.roleType||4==t.roleType?[t._m(0),t._v(" "),a("div",{staticClass:"clock-table"},[a("div",{staticClass:"cells"},t._l(t.clockList,function(e,s){return a("div",{key:s,staticClass:"cell",on:{click:function(a){t.handleQueryClock(e)}}},[a("div",{staticClass:"cell-bd"},[a("p",{},[t._v(t._s(e.className))])]),t._v(" "),a("div",{staticClass:"cell-bd"},[a("p",{},[t._v(t._s(e.classCount))])]),t._v(" "),a("div",{staticClass:"cell-bd"},[a("p",{},[t._v(t._s(e.clockCount))])]),t._v(" "),a("div",{staticClass:"cell-bd"},[a("van-circle",{attrs:{rate:e.clockRate,color:"#07c160","layer-color":"#ebedf0",size:"42px",text:e.clockRate.toFixed(0)+"%"},model:{value:e.clockRate,callback:function(a){t.$set(e,"clockRate",a)},expression:"clock.clockRate"}})],1)])}))])]:[a("div",{staticClass:"clock-show-table"},[a("div",{staticClass:"cells"},t._l(t.clockMonthList,function(e,s){return a("div",{key:s,staticClass:"cell",staticStyle:{height:"50px"}},[a("div",{staticClass:"cell-bd",staticStyle:{"padding-left":"0"}},[t._v(t._s(e)+"已打卡")]),t._v(" "),a("div",{staticClass:"cell-ft",staticStyle:{color:"#92cd36"},on:{click:function(a){t.handleClockDay(e)}}},[t._v("查看详情")])])}))])],t._v(" "),3==t.roleType?[a("div",{staticClass:"_confirm"},[a("a",{staticClass:"btn btn-large btn-primary",attrs:{href:"javascript:void(0);"},on:{click:t.handleAddPunch}},[t._v("打卡接送")])])]:t._e()],2)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"clock-table"},[e("div",{staticClass:"cells"},[e("div",{staticClass:"cell",attrs:{"size-17":""}},[e("div",{staticClass:"cell-bd"},[this._v("班级")]),this._v(" "),e("div",{staticClass:"cell-bd"},[this._v("应到人数")]),this._v(" "),e("div",{staticClass:"cell-bd"},[this._v("实到人数")]),this._v(" "),e("div",{staticClass:"cell-bd"},[this._v("出勤率")])])])])}]};var _=a("VU/8")(k,m,!1,function(t){a("+lRy")},"data-v-fed1f240",null);e.default=_.exports}});